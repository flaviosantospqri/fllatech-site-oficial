name: Deploy via FTP

on:
  push:
    branches:
      - main

jobs:
  deploy:
    name: ğŸš€ Build e Deploy Next.js
    runs-on: ubuntu-latest
    steps:
      # Checkout do cÃ³digo
      - name: ğŸ”„ Checkout do repositÃ³rio
        uses: actions/checkout@v3

      # ConfiguraÃ§Ã£o do Node.js
      - name: ğŸ“Œ Configurar Node.js
        uses: actions/setup-node@v3
        with:
          node-version: "18" # Ajuste conforme necessÃ¡rio

      # Instalar dependÃªncias
      - name: ğŸ“¦ Instalar dependÃªncias
        run: npm install

      # Construir o projeto
      - name: ğŸ› ï¸ Build do Next.js
        run: npm run build

      # Verificar se o diretÃ³rio `.next/` existe
      - name: ğŸ“‚ Listar arquivos gerados
        run: ls -la .next/

      # Deploy via FTP
      - name: ğŸš€ FTP Deploy Locaweb
        uses: locaweb/ftp-deploy@1.0.0
        with:
          host: ${{ secrets.FTP_SERVER }}
          user: ${{ secrets.FTP_USERNAME }}
          password: ${{ secrets.FTP_PASSWORD }}
          localDir: .next/  # DiretÃ³rio correto gerado pelo build
          remoteDir: public_html/  # Ajuste conforme seu servidor
          debug: true  # Ativa logs detalhados para diagnÃ³stico
